(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))f(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const m of s.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&f(m)}).observe(document,{childList:!0,subtree:!0});function l(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function f(i){if(i.ep)return;i.ep=!0;const s=l(i);fetch(i.href,s)}})();const o={READY:"ready",WAITING:"waiting",ACTIVE:"active",RESULT:"result",PENALTY:"penalty"},a={MIN_DELAY:1e3,MAX_DELAY:4e3,REACTION_TIMEOUT:2e3,PENALTY_DURATION:1500,RESULT_DURATION:3e3};let t={current:o.READY,startTime:0,reactionTime:0,bestTime:null,waitingTimeout:null,reactionTimeout:null,resultTimeout:null,penaltyTimeout:null},c={};const u="r1_reaction_timer_best",T=typeof PluginMessageHandler<"u";console.log(T?"Running as R1 Creation":"Running in browser mode");function r(e){g();const n=document.getElementById("app"),l=t.current;t.current=e,n.classList.remove(`state-${l}`),n.classList.add(`state-${e}`),A(),console.log(`State changed: ${l} â†’ ${e}`)}function g(){t.waitingTimeout&&(clearTimeout(t.waitingTimeout),t.waitingTimeout=null),t.reactionTimeout&&(clearTimeout(t.reactionTimeout),t.reactionTimeout=null),t.resultTimeout&&(clearTimeout(t.resultTimeout),t.resultTimeout=null),t.penaltyTimeout&&(clearTimeout(t.penaltyTimeout),t.penaltyTimeout=null)}function A(){const e=c.statusText,n=c.timer;switch(t.current){case o.READY:e.textContent="Press PTT to Start",n.textContent="0.000s",n.classList.remove("highlight");break;case o.WAITING:e.textContent="Wait for Green...",n.textContent="WAIT",n.classList.remove("highlight");break;case o.ACTIVE:e.textContent="REACT NOW!",n.textContent="GO!",n.classList.add("highlight");break;case o.PENALTY:e.textContent="Too Early!",n.textContent="PENALTY",n.classList.remove("highlight");break;case o.RESULT:e.textContent="Your Time:",n.textContent=E(t.reactionTime),n.classList.add("highlight"),(!t.bestTime||t.reactionTime<t.bestTime)&&(t.bestTime=t.reactionTime,p(),d(),e.textContent="NEW BEST!");break}}function E(e){return(e/1e3).toFixed(3)+"s"}function L(){if(t.current!==o.READY&&t.current!==o.RESULT)return;r(o.WAITING);const e=a.MIN_DELAY+Math.random()*(a.MAX_DELAY-a.MIN_DELAY);t.waitingTimeout=setTimeout(()=>{r(o.ACTIVE),t.startTime=performance.now(),t.reactionTimeout=setTimeout(()=>{y()},a.REACTION_TIMEOUT)},e)}function b(){const e=performance.now();switch(t.current){case o.READY:case o.RESULT:L();break;case o.WAITING:R();break;case o.ACTIVE:t.reactionTime=e-t.startTime,r(o.RESULT),t.resultTimeout=setTimeout(()=>{r(o.READY)},a.RESULT_DURATION);break;case o.PENALTY:break}}function R(){r(o.PENALTY),t.penaltyTimeout=setTimeout(()=>{r(o.READY)},a.PENALTY_DURATION)}function y(){c.statusText.textContent="Too Slow!",c.timer.textContent="TIMEOUT",t.resultTimeout=setTimeout(()=>{r(o.READY)},a.RESULT_DURATION)}async function I(){try{if(window.creationStorage){const e=await window.creationStorage.plain.getItem(u);e&&(t.bestTime=JSON.parse(atob(e)))}else{const e=localStorage.getItem(u);e&&(t.bestTime=JSON.parse(e))}}catch(e){console.error("Error loading best time:",e)}d()}async function p(){try{if(window.creationStorage){const e=btoa(JSON.stringify(t.bestTime));await window.creationStorage.plain.setItem(u,e)}else localStorage.setItem(u,JSON.stringify(t.bestTime));console.log("Best time saved:",t.bestTime)}catch(e){console.error("Error saving best time:",e)}}function d(){const e=c.bestTime;t.bestTime?e.textContent=E(t.bestTime):e.textContent="---.---s"}window.addEventListener("sideClick",()=>{console.log("Side button clicked"),b()});window.addEventListener("scrollUp",()=>{console.log("Scroll up detected")});window.addEventListener("scrollDown",()=>{console.log("Scroll down detected")});window.addEventListener("longPressStart",()=>{console.log("Long press started")});window.addEventListener("longPressEnd",()=>{console.log("Long press ended")});window.onPluginMessage=function(e){console.log("Received plugin message:",e)};function w(){t.bestTime=null,p(),d(),console.log("Best time reset")}document.addEventListener("DOMContentLoaded",()=>{console.log("R1 Reaction Timer initialized!"),c={statusText:document.getElementById("status-text"),timer:document.getElementById("timer"),bestTime:document.getElementById("best-time")};for(const[e,n]of Object.entries(c))if(!n){console.error(`Required element not found: ${e}`);return}I(),r(o.READY),T||(window.addEventListener("keydown",e=>{e.code==="Space"&&(e.preventDefault(),window.dispatchEvent(new CustomEvent("sideClick"))),e.code==="KeyR"&&e.ctrlKey&&(e.preventDefault(),w())}),console.log("Development mode: Space = PTT button, Ctrl+R = Reset best time")),console.log("Game ready! Press PTT button to start.")});window.addEventListener("beforeunload",()=>{g()});T||(window.reactionTimer={gameState:t,setState:r,resetBestTime:w,GameStates:o});
